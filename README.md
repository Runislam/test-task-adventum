## Структура данных

### Исходная таблица `posts`

| Столбец       | Тип данных | Описание                       |
| ------------- | ---------- | ------------------------------ |
| id            | integer    | Уникальный идентификатор поста |
| datetime_post | timestamp  | Дата и время публикации        |
| likes         | integer    | Количество лайков              |

**Период данных:** 2020-2025  
**Количество постов:** 21

## SQL-запросы и результаты

### 1. Анализ времени суток
```sql
select
    case
        when extract(hour from datetime_post) between 5 and 10 then 'Утро (5–10)'
        when extract(hour from datetime_post) between 11 and 16 then 'День (11–16)'
        when extract(hour from datetime_post) between 17 and 23 then 'Вечер (17–23)'
        else 'Ночь (0–4)'
    end as "Время суток",
    round(avg(likes), 2) as "Среднее количество лайков",
    count(*) as "Количество постов"
from posts
group by "Время суток"
order by "Среднее количество лайков" desc;
```

**Результат:**

| Время суток   | Среднее количество лайков | Количество постов |
| ------------- | ------------------------- | ----------------- |
| Вечер (17–23) | 109.90                    | 10                |
| Ночь (0–4)    | 95.50                     | 2                 |
| День (11–16)  | 50.89                     | 9                 |

---

### 2. Анализ дней недели
```sql
select
    case extract(dow from datetime_post)
        when 1 then 'Понедельник'
        when 2 then 'Вторник'
        when 3 then 'Среда'
        when 4 then 'Четверг'
        when 5 then 'Пятница'
        when 6 then 'Суббота'
        when 0 then 'Воскресенье'
    end as "День недели",
    round(avg(likes), 2) as "Среднее количество лайков",
    count(*) as "Количество постов"
from posts
group by "День недели", extract(dow from datetime_post)
order by extract(dow from datetime_post);
```

**Результат:**

| День недели | Среднее количество лайков | Количество постов |
|-------------|---------------------------|-------------------|
| Воскресенье | 58.00 | 2 |
| Понедельник | 96.75 | 4 |
| Вторник | 118.25 | 4 |
| Среда | 115.50 | 4 |
| Четверг | 64.00 | 2 |
| Пятница | 75.00 | 1 |
| Суббота | 26.75 | 4 |

---

### 3. Анализ промежутков между постами
```sql
select
    id as "ID поста",
    datetime_post as "Дата публикации",
    round(extract(epoch from (datetime_post - lag(datetime_post) over (order by datetime_post))) / 86400, 0) as "Дней с предыдущего поста",
    likes as "Лайки"
from posts
order by "Лайки" desc;
```

**Результат**

| ID поста | Дата публикации     | Дней с предыдущего поста | Лайки |
| -------- | ------------------- | ------------------------ | ----- |
| 9        | 2023-11-29 20:55:00 | 254                      | 259   |
| 2        | 2024-09-17 22:18:00 | 132                      | 186   |
| 10       | 2023-03-20 12:51:00 | 9                        | 159   |
| 14       | 2022-08-08 17:21:00 | 6                        | 158   |
| 8        | 2024-03-13 00:56:00 | 104                      | 141   |
| 15       | 2022-08-02 23:41:00 | 65                       | 107   |
| 17       | 2022-05-24 22:26:00 | 442                      | 106   |
| 21       | 2020-02-08 20:59:00 |                          | 76    |
| 5        | 2024-04-05 11:07:00 | 22                       | 75    |
| 4        | 2024-04-23 11:28:00 | 18                       | 74    |
| 6        | 2024-03-14 17:22:00 | 2                        | 72    |
| 16       | 2022-05-29 23:41:00 | 5                        | 71    |
| 20       | 2020-10-22 22:01:00 | 257                      | 56    |
| 7        | 2024-03-13 01:15:00 | 0                        | 50    |
| 13       | 2023-01-16 13:33:00 | 161                      | 48    |
| 12       | 2023-02-05 16:24:00 | 20                       | 45    |
| 18       | 2021-03-08 16:54:00 | 93                       | 22    |
| 1        | 2025-01-18 12:45:00 | 123                      | 17    |
| 3        | 2024-05-08 15:58:00 | 15                       | 12    |
| 19       | 2020-12-05 19:27:00 | 44                       | 8     |
| 11       | 2023-03-11 15:24:00 | 34                       | 6     |

---

### 4. Сравнение факторов (коэффициент вариации)
```sql
select 'Время суток' as "Фактор",
       round(max(avg_likes) / nullif(min(avg_likes), 0), 2) as "Соотношение макс/мин"
from (select avg(likes) as avg_likes from posts group by extract(hour from datetime_post)) t
union all
select 'День недели',
       round(max(avg_likes) / nullif(min(avg_likes), 0), 2)
from (select avg(likes) as avg_likes from posts group by extract(dow from datetime_post)) t
union all
select 'Промежуток между постами',
       round(max(avg_likes) / nullif(min(avg_likes), 0), 2)
from (
    select avg(likes) as avg_likes
    from (
        select likes,
               floor(extract(epoch from (datetime_post - lag(datetime_post) over (order by datetime_post))) / 86400) as days_gap
        from posts
    ) t
    where days_gap is not null
    group by days_gap
) t
order by "Соотношение макс/мин" desc;
```

**Результат:**

| Фактор                   | Соотношение макс/мин |
| ------------------------ | -------------------- |
| Промежуток между постами | 43.17                |
| Время суток              | 20.94                |
| День недели              | 4.42                 |

---

## Выводы

### 1. Анализ времени суток

По результатам запроса видно что больше всего постов выходит днем и вечером, 
но в вечернее время количество лайков гораздо больше - 110 лайков против 51 днем (разница в 2 раза).

### 2. Анализ дней недели

Запрос показывает, что понедельник, вторник и среда дают лучший результат (96-118 лайков). Хуже всего себя показывает суббота (27 лайков), несмотря на то что количество постов в этот день такое же (4 поста). 
### 3. Анализ промежутков между постами

Четкой закономерности не наблюдается. Посты успешны как при коротких промежутках (6-9 дней), так и при очень длинных (132-254 дня). Вероятно, на успех поста больше влияет его содержание, а не частота публикаций.

### 4. Сравнение факторов (коэффициент вариации)

**Промежуток между постами** имеет максимальное соотношение (43.17), но, как показал детальный анализ (запрос 3), чёткой закономерности не выявлено. Высокое соотношение связано с тем, что в выборке есть единичные посты с экстремальными промежутками, что создаёт статистическую аномалию.

**Время суток** показывает высокое соотношение (20.94) **и имеет чёткую закономерность**: вечерние посты стабильно получают в среднем 110 лайков против 51 у дневных (разница в 2 раза). При этом достаточное количество постов в каждой категории (9-10 постов) делает этот вывод надёжным.

**День недели** имеет наименьшее соотношение (4.42), что говорит о более равномерном распределении результатов по дням недели. Однако малое количество постов на каждый день (1-4 поста) не позволяет сделать надёжные выводы.

---

## Общий вывод

**Наибольшее влияние на количество лайков оказывает время публикации.**

Несмотря на то, что промежуток между постами показывает наибольшее соотношение макс/мин, реальную закономерность демонстрирует именно **время суток**. Вечерние посты стабильно показывают результат в 2 раза лучше дневных публикаций — 110 лайков против 51.

**Рекомендация:** публиковать посты в вечернее время (17-23 часа) для максимизации количества лайков.

---
## Технические детали

- **СУБД:** PostgreSQL
- **Инструменты:** SQL
- **Период анализа:** 2020-2025
- **Объем выборки:** 21 пост